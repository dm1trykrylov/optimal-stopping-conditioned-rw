
\begin{algorithm}
	\caption{Рекурсивное вычисление $\ell(n,k)$, $p(n,k)$ и $m(n,k)$}
	\label{alg:lpmm}
	\begin{algorithmic}[1]

		\STATE \textbf{Вход:} $N$; границы $L(n)$ и $U(n)$.
		\STATE $V_n = \{ k \in \mathbb{Z} : L(n) \le k \le U(n) \}$.

		\STATE

		\STATE \textbf{1: Инициализация $m$ и $\ell$ на последнем шаге.}
		\FOR{each $k \in V_N$}
		\STATE $\ell(N,k) \gets 1$
		\STATE $m(N,k) \gets k$
		\ENDFOR

		\STATE

		\STATE \textbf{2: Вычисление $\ell(n,k)$.}
		\FOR{$n = N-1, N-2, \dots, 0$}
		\FOR{each $k \in V_n$}
		\STATE $\ell(n,k) \gets \ell(n+1,k+1) + \ell(n+1,k-1)$
		\ENDFOR
		\ENDFOR

		\STATE

		\STATE \textbf{3: Вычисление вероятности $p(n,k)$.}
		\FOR{$n = 0, 1, \dots, N-1$}
		\FOR{each $k \in V_n$}
		\IF{$\ell(n,k) = 0$}
		\STATE $p(n,k) \gets 0$
		\ELSE
		\STATE $p(n,k) \gets \ell(n+1,k+1) / \ell(n,k)$
		\ENDIF
		\ENDFOR
		\ENDFOR

		\STATE

		\STATE \textbf{4: Вычисление $m(n,k)$.}
		\FOR{$n = N-1, N-2, \dots, 0$}
		\FOR{each $k \in V_n$}
		\STATE $\text{cont} \gets p(n,k) \, m(n+1,k+1) + (1 - p(n,k)) \, m(n+1,k-1)$
		\STATE $m(n,k) \gets \max \{ k, \text{cont} \}$
		\ENDFOR
		\ENDFOR

		\STATE

		\STATE \textbf{Выход:} $\ell(n,k)$, $p(n,k)$ и $m(n,k)$.

	\end{algorithmic}
\end{algorithm}

