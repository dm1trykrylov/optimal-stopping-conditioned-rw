# Задача об оптимальной остановке для случайного блуждания с ограничениями

Учебный проект по курсу **Введение в финансовые рынки**, посвящённый задаче оптимальной остановки для дискретного случайного блуждания с дополнительным условием оставаться между линейными границами. Эта модель применима к цене актива, находящейся в заданном коридоре.

## Постановка задачи

Для симметричного случайного блуждания в дискретном времени с единичным шагом, ограниченного линейными границами, требуется построить правило остановки, максимизирующее математическое ожидание цены при продаже. Блуждание стартует из нуля.

## Подходы

### Теоретический подход
- Формализация задачи оптимальной остановки ($S_{t}$ --- симметричное случайное блуждание)
$$
    X_{t} = \left( S_{t} \mid \forall k \in \{0,\ldots,N\} \; a + b\cdot k \leq S_{k} \leq x + d\cdot k \right)
$$
- Вывод оптимального правила
$$
    m(n, k) = \sup\limits_{n \leq t \leq N} E \left( X_{t} \mid X_{n} = k \right),\; m(n, k) = k \Rightarrow \text{ Остановка }
$$
- Получение рекурсивных формул для правила
$$
    m(n, k) = \max\left(k, p \cdot m(n + 1, k + 1) + (1 - p) \cdot m(n + 1, k - 1) \right),
$$
$$
    p = p(n, k) = \frac{l(n + 1, k + 1)}{l(n, k)}, 
$$
$$
    l(n, k) = l(n + 1, k + 1) + l(n + 1, k - 1) \text{ (если существуют)}
$$
- Аналитическое исследование свойств стратегии, подробнее - в [отчёте](main.tex) по проекту.

### Машинное обучение
- Модель GRU
- Предсказание будущей цены по истории и границам (задаются явно)
- Обучение стратегии продажи напрямую на максимизацию прибыли
- Эксперименты на синтетических данных

## Ключевые результаты

### Количественное сравнение

| Длина траектории (N) | Epochs | ML — средняя прибыль | Теоретический подход |
|---------------------|--------|----------------------|----------------------|
| 100                 | 50     | 0.79                 | 0.82                 |
| 200                 | 50     | 0.73                 | 0.76                 |
| 400                 | 50     | 0.55                 | 0.74                 |
| 400                 | 100    | 0.74                 | 0.74                 |

### Зависимость прибыли от порога

Графики средней прибыли в зависимости от порога принятия решения представлены для разных значений \(N\):

- [N=100](images/profit_vs_threshold_validation_N100.png)
- [N=200](images/profit_vs_threshold_validation_N200.png)
- [N=400, epochs = 50](images/profit_vs_threshold_validation_N400.png)
- [N=400, epochs = 100](images/profit_vs_threshold_validation_N400b.png)

Они демонстрируют устойчивость теоретического оптимального порога и сходимость ML-стратегии к оптимуму.

## Материалы проекта

- Презентация с введением и мотивацией: [intro-slides](intro-slides.pdf)
- Финальный отчёт и презентация с результатами: [final-report](final-report.pdf), [final-slides](final-slides.pdf)
- Дополнительная презентация с теоретическими подробностями и направлениями дальнейшей работы: [report-slides](report-slides.pdf)

## Вклад авторов

Андрей Стрелков
- Реализация ML-подхода
- Эксперименты
Дмитрий Крылов
- Теоретическая постановка задачи и её решение
- Вывод оптимального правила и доказательства

